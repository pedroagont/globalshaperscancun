!function(a){a.fn.ttwMusicPlayer=function(t,e){function n(a){return o(b[a].title)?o(b[a].mp3)?o(b[a].oga)?"":i(b[a].oga):i(b[a].mp3):b[a].title}function i(a){return a=a.split("/"),a[a.length-1]}function s(a,t,e){if("track"==a)o(b[e].rating)||l(t,b[e].rating);else{var n=o(b[e].rating)?0:Math.ceil(b[e].rating);r(n)}}function r(a){P.find(d.trackInfo).find(d.ratingLevel).removeClass(c(d.ratingLevelOn)).slice(0,a).addClass(c(d.ratingLevelOn))}function l(a,t){a.find(d.ratingLevel).removeClass(c(d.ratingLevelOn)).slice(0,2*t).addClass(c(d.ratingLevelOn))}function c(a){return a.substr(1)}function o(a){return"undefined"==typeof a}var p,u,d,v,y,g,f,t,m,h,b,j,P=this;d={jPlayer:"#jquery_jplayer",jPlayerInterface:".jp-interface",playerPrevious:".jp-interface .jp-previous",playerNext:".jp-interface .jp-next",trackList:".tracklist",tracks:".tracks",track:".track",trackRating:".rating-bar",trackInfo:".track-info",rating:".rating",ratingLevel:".rating-level",ratingLevelOn:".on",rating_succes:".rating-succes",title:".title",duration:".duration",buy:".buy",buyNotActive:".not-active",playing:".playing",moreButton:".more",player:".player",artist:".artist",artistOuter:".artist-outer",albumCover:".img",description:".description",descriptionShowing:".showing"},p={ratingCallback:null,currencySymbol:"$",buyText:"BUY",tracksToShow:5,autoplay:!1,jPlayer:{}},u=a.extend(!0,{},p,e),b=t,j=0,v=function(){t=new y,m=new g,m.buildInterface(),t.init(u.jPlayer),P.bind("mbPlaylistLoaded",function(){P.bind("mbInterfaceBuilt",function(){h=new f}),m.init()})},y=function(){function t(t){L=a(".ttw-music-player .jPlayer-container");var n,i;n={swfPath:"jquery-jplayer",supplied:"mp3, oga",solution:"html, flash",cssSelectorAncestor:d.jPlayerInterface,errorAlerts:!1,warningAlerts:!1},i=a.extend(!0,{},n,t),L.bind(a.jPlayer.event.ready,function(){L.bind(a.jPlayer.event.ended,function(a){l()}),L.bind(a.jPlayer.event.play,function(a){L.jPlayer("pauseOthers"),k.eq(j).addClass(c(d.playing)).siblings().removeClass(c(d.playing))}),L.bind(a.jPlayer.event.playing,function(a){C=!0}),L.bind(a.jPlayer.event.pause,function(a){C=!1}),a(d.playerPrevious).click(function(){return p(),a(this).blur(),!1}),a(d.playerNext).click(function(){return l(),a(this).blur(),!1}),P.bind("mbInitPlaylistAdvance",function(a){var t=this.getData("mbInitPlaylistAdvance");t!=j?(j=t,r(j)):L.data("jPlayer").status.srcSet?v():r(0)}),y(),P.trigger("mbPlaylistLoaded"),e(u.autoplay)}),L.jPlayer(i)}function e(a){j=0,a?r(j):(i(j),P.trigger("mbPlaylistInit"))}function i(a){j=a,L.jPlayer("setMedia",b[j])}function r(a){i(a),a>=u.tracksToShow&&g(),P.trigger("mbPlaylistAdvance"),L.jPlayer("play")}function l(){var a=j+1<b.length?j+1:0;r(a)}function p(){var a=j-1>=0?j-1:b.length-1;r(a)}function v(){C?L.jPlayer("pause"):L.jPlayer("play")}function y(){var t=a();x=P.find(d.tracks);for(var e=0;10>e;e++)t=t.add(A.ratingBar);for(var i=0;i<b.length;i++){var l=a(A.listItem);l.find(d.rating).html(t.clone()),l.find(d.title).html(n(i)),l.find(d.duration).html(f(i)),s("track",l,i),m(l,i),l.data("index",i),x.append(l)}if(k=a(d.track),k.slice(0,u.tracksToShow).each(function(){I+=a(this).outerHeight()}),k.slice(u.tracksToShow,b.length).each(function(){B+=a(this).outerHeight()}),B>0){var c=a(d.trackList);x.height(I),c.addClass("show-more-button"),c.find(d.moreButton).click(function(){w=a(this),g()})}k.find(".title").click(function(){r(a(this).parents("li").data("index"))})}function g(){o(w)&&(w=P.find(d.moreButton)),x.animate({height:I+B},function(){w.animate({opacity:0},function(){w.slideUp(function(){w.parents(d.trackList).removeClass("show-more-button"),w.remove()})})})}function f(a){return o(b[a].duration)?"-":b[a].duration}function m(a,t){o(b[t].buy)||a.find(d.buy).removeClass(c(d.buyNotActive)).attr("href",b[t].buy).html(h(t))}function h(a){return(o(b[a].price)?"":u.currencySymbol+b[a].price)+" "+u.buyText}var A,k,x,w,C=!1,L={},I=0,B=0;return A={listItem:'<li class="track"><span class="title"></span><span class="duration"></span><a href="#" class="buy not-active" target="_blank"></a></li>',ratingBar:'<span class="rating-level rating-bar"></span>'},{init:t,playlistInit:e,playlistAdvance:r,playlistNext:l,playlistPrev:p,togglePlay:v,$myJplayer:L}},f=function(){function t(){a(d.rating_succes).css("display","none"),a(d.ratingLevel).click(function(){var t=a(this),e=t.parent().children().index(t)+1,n=a(d.title+":first").text(),i="action=my_special_ajax_call5&rating="+e+"&trackname="+n;jQuery.ajax({type:"POST",url:ajaxurl,cache:!1,data:i,beforeSend:function(){},success:function(t){a(d.rating_succes).html(t).fadeIn(500).delay(1e3).fadeOut(500)}}),t.prevAll().add(t).addClass(c(d.ratingLevelOn)).end().end().nextAll().removeClass(c(d.ratingLevelOn))})}P.find(d.track);a(d.rating).find(d.ratingLevel).hover(function(){a(this).addClass("hover").prevAll().addClass("hover").end().nextAll().removeClass("hover")}),a(d.rating).mouseleave(function(){a(this).find(d.ratingLevel).removeClass("hover")}),t()},g=function(){function t(){v=a(d.player),y=v.find(d.title),g=v.find(d.artist),f=v.find(d.albumCover),p(),P.bind("mbPlaylistAdvance mbPlaylistInit",function(){i(),r(),s("current",null,j),l()})}function e(){var t,e;t='<div class="ttw-music-player"><div class="player jp-interface"><div class="album-cover"><span class="img"></span>            <span class="highlight"></span>        </div>        <div class="track-info">            <p class="title"></p>            <p class="artist-outer">By <span class="artist"></span></p>            <div class="rating">                <span class="rating-level rating-star on"></span>                <span class="rating-level rating-star on"></span>                <span class="rating-level rating-star on"></span>                <span class="rating-level rating-star on"></span>                <span class="rating-level rating-star"></span>				 <span class="rating-succes">Already rated</span>            </div>        </div>        <div class="player-controls">            <div class="main">                <div class="previous jp-previous"></div>                <div class="play jp-play"></div>                <div class="pause jp-pause"></div>                <div class="next jp-next"></div><!-- These controls aren\'t used by this plugin, but jPlayer seems to require that they exist -->                <span class="unused-controls">                    <span class="jp-video-play"></span>                    <span class="jp-stop"></span>                    <span class="jp-mute"></span>                    <span class="jp-unmute"></span>                    <span class="jp-volume-bar"></span>                    <span class="jp-volume-bar-value"></span>                    <span class="jp-volume-max"></span>                    <span class="jp-current-time"></span>                    <span class="jp-duration"></span>                    <span class="jp-full-screen"></span>                    <span class="jp-restore-screen"></span>                    <span class="jp-repeat"></span>                    <span class="jp-repeat-off"></span>                    <span class="jp-gui"></span>                </span>            </div>            <div class="progress-wrapper">                <div class="progress jp-seek-bar">                    <div class="elapsed jp-play-bar"></div>                </div>            </div>        </div>    </div>    <div class="tracklist">        <ol class="tracks"> </ol>        <div class="more">View More...</div>    </div>    <div class="jPlayer-container"></div></div>',e=a(t).css({display:"none",opacity:0}).appendTo(P).slideDown("slow",function(){e.animate({opacity:1}),P.trigger("mbInterfaceBuilt")})}function i(){y.html(n(j))}function r(){o(b[j].artist)?g.parent(d.artistOuter).animate({opacity:0},"fast"):g.html(b[j].artist).parent(d.artistOuter).animate({opacity:1},"fast")}function l(){f.animate({opacity:0},"fast",function(){if(!o(b[j].cover)){var a=j;a==j&&f.css({opacity:1}).html('<img src="'+b[j].cover+'" alt="album cover" />')}})}function p(){o(u.description)||P.find(d.description).html(u.description).addClass(c(d.descriptionShowing)).slideDown()}var v,y,g,f;return{buildInterface:e,init:t}},v()}}(jQuery),function(a){a.fn.imagesLoaded=function(a){var t=this.filter("img"),e=t.length;return t.bind("load",function(){--e<=0&&a.call(t,this)}).each(function(){if(this.complete||void 0===this.complete){var a=this.src;this.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",this.src=a}}),this}}(jQuery);var myPlaylist=[{mp3:"media/Dream-Music-Relax.mp3",oga:"media/Dream-Music-Relax.ogg",title:"Energy",artist:"Young & Free",rating:"5",buy:"Buy",price:"123",duration:"3:30",cover:"http://placehold.it/270x294.jpg"},{mp3:"media/Dream-Music-Relax.mp3",oga:"media/Dream-Music-Relax.ogg",title:"Pursue",artist:"Young & Free",rating:"5",buy:"Buy",price:"123",duration:"7:03",cover:"http://placehold.it/370x359.jpg"},{mp3:"media/Dream-Music-Relax.mp3",oga:"media/Dream-Music-Relax.ogg",title:"This Is Living (Acoustic)",artist:"Young & Free",rating:"5",buy:"Buy",price:"123",duration:"4:24",cover:"http://placehold.it/370x359.jpg"},{mp3:"media/Dream-Music-Relax.mp3",oga:"media/Dream-Music-Relax.ogg",title:"Sinking Deep",artist:"Young & Free",rating:"5",buy:"Buy",price:"123",duration:"4:07",cover:"http://placehold.it/270x294.jpg"}];jQuery(document).ready(function(){jQuery("#myplayer").ttwMusicPlayer(myPlaylist,{currencySymbol:"",description:"",buyText:"",tracksToShow:4,autoplay:!1})});